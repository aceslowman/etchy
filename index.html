<!DOCTYPE html>

<html>
  <head>
    <script type="text/javascript">
      var ws = new WebSocket("wss://public-sphere.glitch.me");

      ws.onmessage = function(evt) {
        var received_msg = JSON.parse(evt.data);
        const chat = document.getElementById("chat")
        const li = document.createElement("li")
        li.appendChild(document.createTextNode(received_msg.message + " your id is: " + received_msg.uuid))
        chat.appendChild(li)
      };

      function send() {
        const textArea = document.getElementById("message");
        const message = textArea.value;
        ws.send(message);
        textArea.value = "";
      }
      
      function register() {
        console.log('sending a message to the server to register')
        const registration = {
          type: 'REGISTER',
          nickname: 'aceslowman'
        }
        ws.send(JSON.stringify(registration));
      }

    </script>
  </head>

  <body>
    <h2>
      Send messages
    </h2>
    <textarea id="message"></textarea>
    <button onclick="send()">
      Send
    </button>
    <h2>
      Replies from server
    </h2>
    <ul id="chat"></ul>
    <button onclick="register()">
      Register
    </button>
  </body>
</html>
