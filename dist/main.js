/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./src/ContextBlender.js":
/*!*******************************!*\
  !*** ./src/ContextBlender.js ***!
  \*******************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("// https://github.com/Phrogz/context-blender\n\n(function(){\n\nvar defaultOffsets = {\n\tdestX   : 0,\n\tdestY   : 0,\n\tsourceX : 0,\n\tsourceY : 0,\n\twidth   : 'auto',\n\theight  : 'auto'\n};\n\nif (true){\n\tvar canvas = __webpack_require__(/*! canvas */ \"../rbd/pnpm-volume/7461d640-0f67-4c49-a77d-db2fb185b90f/node_modules/.registry.npmjs.org/canvas/2.8.0/node_modules/canvas/browser.js\");\n\taddBlendMethod(canvas.Context2d.prototype);\n\tmodule.exports = canvas;\n} else {}\n\nfunction addBlendMethod(object){\n\tif (!object || typeof object.getImageData!=='function') return console.error(\"context blender called without a valid context prototype\");\n\tObject.defineProperty(object,'blendOnto',{value:blendOnto});\n\n\t// For querying of functionality from other libraries\n\tvar modes = blendOnto.supportedBlendModes = 'normal src-over screen multiply difference src-in plus add overlay hardlight colordodge dodge colorburn burn darken darker lighten lighter exclusion softlight luminosity color hue saturation lightercolor darkercolor'.split(' ');\n\tvar supports = blendOnto.supports = {};\n\tfor (var i=modes.length;i--;) supports[modes[i]] = true;\n\tblendOnto.aliases = { \"src-over\":\"normal\", plus:\"add\", dodge:\"colordodge\", burn:\"colorburn\", darker:\"darken\", lighter:\"lighten\" };\n\treturn object;\n}\n\nfunction blendOnto(destContext,blendMode,offsetOptions){\n\t\tvar offsets={};\n\t\tfor (var key in defaultOffsets){\n\t\t\tif (defaultOffsets.hasOwnProperty(key)){\n\t\t\t\toffsets[key] = (offsetOptions && offsetOptions[key]) || defaultOffsets[key];\n\t\t\t}\n\t\t}\n\t\tif (offsets.width =='auto') offsets.width =this.canvas.width;\n\t\tif (offsets.height=='auto') offsets.height=this.canvas.height;\n\t\toffsets.width  = Math.min(offsets.width, this.canvas.width-offsets.sourceX, destContext.canvas.width-offsets.destX );\n\t\toffsets.height = Math.min(offsets.height,this.canvas.height-offsets.sourceY,destContext.canvas.height-offsets.destY);\n\n\t\tvar srcD = this.getImageData(offsets.sourceX,offsets.sourceY,offsets.width,offsets.height);\n\t\tvar dstD = destContext.getImageData(offsets.destX,offsets.destY,offsets.width,offsets.height);\n\t\tvar src  = srcD.data;\n\t\tvar dst  = dstD.data;\n\t\tvar sA, dA, len=dst.length;\n\t\tvar sRA, sGA, sBA, dRA, dGA, dBA, dA2,\n\t\t    r1,g1,b1, r2,g2,b2;\n\t\tvar demultiply;\n\n\t\tfunction Fsoftlight(a,b) {\n\t\t\t/*\n\t\t\t\thttp://en.wikipedia.org/wiki/Blend_modes#Soft_Light\n\t\t\t\t2ab+a^2 (1-2b), if b<0.5\n\t\t\t\t2a(1-b) +sqrt(a)(2b-1), otherwise\n\t\t\t*/\n\t\t\tvar b2=b<<1;\n\t\t\tif (b<128) return (a*(b2+(a*(255-b2)>>8)))>>8;\n\t\t\telse       return (a*(511-b2)+(Math.sqrt(a<<8)*(b2-255)))>>8;\n\t\t}\n\n\t\tfunction Foverlay(a,b) {\n\t\t\treturn a<128 ?\n\t\t\t\t(a*b)>>7 : // (2*a*b)>>8 :\n\t\t\t\t255 - (( (255 - b) * (255 - a))>>7);\n\t\t}\n\n\t\tfunction Fdodge(a,b) {\n\t\t\treturn (b==255 && a==0) ? 255 : Math.min(255,(a<<8)/(255-b));\n\t\t}\n\n\t\tfunction Fburn(a,b) {\n\t\t\treturn (b==255 && a==0) ? 0 : 255-Math.min(255,((255-a)<<8)/b);\n\t\t}\n\n\n\t\t/*\n\t\t\t// yyy = similar to YCbCr\n\t\t\t0.2990    0.5870    0.1140\n\t\t\t-0.1687   -0.3313    0.5000\n\t\t\t0.5000   -0.4187   -0.0813\n\t\t*/\n\t\tfunction rgb2YCbCr(r,g,b) {\n\t\t\treturn {\n\t\t\t\tr: 0.2990*r+0.5870*g+0.1140*b,\n\t\t\t\tg: -0.1687*r-0.3313*g+0.5000*b,\n\t\t\t\tb: 0.5000*r-0.4187*g-0.0813*b };\n\t\t}\n\n\t\t/*\n\t\t\t1.0000   -0.0000    1.4020\n\t\t\t1.0000   -0.3441   -0.7141\n\t\t\t1.0000    1.7720    0.0000\n\t\t*/\n\t\tfunction YCbCr2rgb(r,g,b) {\n\t\t\treturn {\n\t\t\t\tr: r +1.4020*b,\n\t\t\t\tg: r-0.3441*g   -0.7141*b,\n\t\t\t\tb: r+1.7720*g };\n\t\t}\n\n\t\tfunction rgb2hsv(r,g,b) {\n\t\t\tvar c=rgb2YCbCr(r,g,b);\n\t\t\tvar s=Math.sqrt(c.g*c.g+c.b*c.b),\n\t\t\t    h=Math.atan2(c.g,c.b);\n\t\t\treturn {h:h, s:s, v:c.r };\n\t\t}\n\n\t\tfunction hsv2rgb(h,s,v) {\n\t\t\tvar g=s*Math.sin(h),\n\t\t\t    b=s*Math.cos(h);\n\t\t\treturn YCbCr2rgb(v,g,b);\n\t\t}\n\n\n\t\tfor (var px=0;px<len;px+=4){\n\t\t\tsA  = src[px+3]/255;\n\t\t\tdA  = dst[px+3]/255;\n\t\t\tdA2 = (sA + dA - sA*dA);\n\t\t\tdst[px+3] = dA2*255;\n\n\t\t\tr1=dst[px], g1=dst[px+1], b1=dst[px+2];\n\t\t\tr2=src[px], g2=src[px+1], b2=src[px+2];\n\n\t\t\tsRA = r2/255*sA;\n\t\t\tdRA = r1/255*dA;\n\t\t\tsGA = g2/255*sA;\n\t\t\tdGA = g1/255*dA;\n\t\t\tsBA = b2/255*sA;\n\t\t\tdBA = b1/255*dA;\n\n\t\t\tdemultiply = 255 / dA2;\n\n\t\t\tvar f1=dA*sA, f2=dA-f1, f3=sA-f1;\n\n\t\t\tswitch(blendMode){\n\t\t\t\t// ******* Very close match to Photoshop\n\t\t\t\tcase 'normal':\n\t\t\t\tcase 'src-over':\n\t\t\t\t\tdst[px  ] = (sRA + dRA - dRA*sA) * demultiply;\n\t\t\t\t\tdst[px+1] = (sGA + dGA - dGA*sA) * demultiply;\n\t\t\t\t\tdst[px+2] = (sBA + dBA - dBA*sA) * demultiply;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'screen':\n\t\t\t\t\tdst[px  ] = (sRA + dRA - sRA*dRA) * demultiply;\n\t\t\t\t\tdst[px+1] = (sGA + dGA - sGA*dGA) * demultiply;\n\t\t\t\t\tdst[px+2] = (sBA + dBA - sBA*dBA) * demultiply;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'multiply':\n\t\t\t\t\tdst[px  ] = (sRA*dRA + sRA*(1-dA) + dRA*(1-sA)) * demultiply;\n\t\t\t\t\tdst[px+1] = (sGA*dGA + sGA*(1-dA) + dGA*(1-sA)) * demultiply;\n\t\t\t\t\tdst[px+2] = (sBA*dBA + sBA*(1-dA) + dBA*(1-sA)) * demultiply;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'difference':\n\t\t\t\t\tdst[px  ] = (sRA + dRA - 2 * Math.min( sRA*dA, dRA*sA )) * demultiply;\n\t\t\t\t\tdst[px+1] = (sGA + dGA - 2 * Math.min( sGA*dA, dGA*sA )) * demultiply;\n\t\t\t\t\tdst[px+2] = (sBA + dBA - 2 * Math.min( sBA*dA, dBA*sA )) * demultiply;\n\t\t\t\tbreak;\n\n\t\t\t\t// ******* Slightly different from Photoshop, where alpha is concerned\n\t\t\t\tcase 'src-in':\n\t\t\t\t\tdA2 = sA*dA;\n\t\t\t\t\tdemultiply = 255 / dA2;\n\t\t\t\t\tdst[px  ] = sRA*dA * demultiply;\n\t\t\t\t\tdst[px+1] = sGA*dA * demultiply;\n\t\t\t\t\tdst[px+2] = sBA*dA * demultiply;\n\t\t\t\t\tdst[px+3] = dA2*255;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'plus':\n\t\t\t\tcase 'add':\n\t\t\t\t\t// Photoshop doesn't simply add the alpha channels; this might be correct wrt SVG 1.2\n\t\t\t\t\tdst[px  ] = Math.min(sRA + dRA,1) * demultiply;\n\t\t\t\t\tdst[px+1] = Math.min(sGA + dGA,1) * demultiply;\n\t\t\t\t\tdst[px+2] = Math.min(sBA + dBA,1) * demultiply;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'overlay':\n\t\t\t\t\tdst[px]   = f1*Foverlay(r1,r2) + f2*r1 + f3*r2;\n\t\t\t\t\tdst[px+1] = f1*Foverlay(g1,g2) + f2*g1 + f3*g2;\n\t\t\t\t\tdst[px+2] = f1*Foverlay(b1,b2) + f2*b1 + f3*b2;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'hardlight': // hardlight(a,b) = overlay(b,a)\n\t\t\t\t\tdst[px]   = f1*Foverlay(r2,r1) + f2*r1 + f3*r2;\n\t\t\t\t\tdst[px+1] = f1*Foverlay(g2,g1) + f2*g1 + f3*g2;\n\t\t\t\t\tdst[px+2] = f1*Foverlay(b2,b1) + f2*b1 + f3*b2;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'colordodge':\n\t\t\t\tcase 'dodge':\n\t\t\t\t\tdst[px]   = f1*Fdodge(r1,r2) + f2*r1 + f3*r2;\n\t\t\t\t\tdst[px+1] = f1*Fdodge(g1,g2) + f2*g1 + f3*g2;\n\t\t\t\t\tdst[px+2] = f1*Fdodge(b1,b2) + f2*b1 + f3*b2;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'colorburn':\n\t\t\t\tcase 'burn':\n\t\t\t\t\tdst[px]   = f1*Fburn(r1,r2) + f2*r1 + f3*r2;\n\t\t\t\t\tdst[px+1] = f1*Fburn(g1,g2) + f2*g1 + f3*g2;\n\t\t\t\t\tdst[px+2] = f1*Fburn(b1,b2) + f2*b1 + f3*b2;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'darken':\n\t\t\t\tcase 'darker':\n\t\t\t\t\tdst[px]   = f1*(r1<r2 ? r1 : r2) + f2*r1 + f3*r2;\n\t\t\t\t\tdst[px+1] = f1*(g1<g2 ? g1 : g2) + f2*g1 + f3*g2;\n\t\t\t\t\tdst[px+2] = f1*(b1<b2 ? b1 : b2) + f2*b1 + f3*b2;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'lighten':\n\t\t\t\tcase 'lighter':\n\t\t\t\t\tdst[px  ] = (sRA<dRA ? dRA : sRA) * demultiply;\n\t\t\t\t\tdst[px+1] = (sGA<dGA ? dGA : sGA) * demultiply;\n\t\t\t\t\tdst[px+2] = (sBA<dBA ? dBA : sBA) * demultiply;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'exclusion':\n\t\t\t\t\tdst[px  ] = (dRA+sRA - 2*dRA*sRA) * demultiply;\n\t\t\t\t\tdst[px+1] = (dGA+sGA - 2*dGA*sGA) * demultiply;\n\t\t\t\t\tdst[px+2] = (dBA+sBA - 2*dBA*sBA) * demultiply;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'softlight':\n\t\t\t\t\tdst[px]   = f1*Fsoftlight(r1,r2) + f2*r1 + f3*r2;\n\t\t\t\t\tdst[px+1] = f1*Fsoftlight(g1,g2) + f2*g1 + f3*g2;\n\t\t\t\t\tdst[px+2] = f1*Fsoftlight(b1,b2) + f2*b1 + f3*b2;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'luminosity':\n\t\t\t\t\tvar hsl  = rgb2YCbCr(r1,g1,b1);\n\t\t\t\t\tvar hsl2 = rgb2YCbCr(r2,g2,b2);\n\t\t\t\t\tvar rgb=YCbCr2rgb(hsl2.r, hsl.g, hsl.b);\n\t\t\t\t\tdst[px]   = f1*rgb.r + f2*r1 + f3*r2;\n\t\t\t\t\tdst[px+1] = f1*rgb.g + f2*g1 + f3*g2;\n\t\t\t\t\tdst[px+2] = f1*rgb.b + f2*b1 + f3*b2;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'color':\n\t\t\t\t\tvar hsl  = rgb2YCbCr(r1,g1,b1);\n\t\t\t\t\tvar hsl2 = rgb2YCbCr(r2,g2,b2);\n\t\t\t\t\tvar rgb=YCbCr2rgb(hsl.r, hsl2.g, hsl2.b);\n\t\t\t\t\tdst[px]   = f1*rgb.r + f2*r1 + f3*r2;\n\t\t\t\t\tdst[px+1] = f1*rgb.g + f2*g1 + f3*g2;\n\t\t\t\t\tdst[px+2] = f1*rgb.b + f2*b1 + f3*b2;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'hue':\n\t\t\t\t\tvar hsl =rgb2hsv(r1,g1,b1);\n\t\t\t\t\tvar hsl2=rgb2hsv(r2,g2,b2);\n\t\t\t\t\tvar rgb=hsv2rgb(hsl2.h, hsl.s, hsl.v);\n\t\t\t\t\tdst[px]   = f1*rgb.r + f2*r1 + f3*r2;\n\t\t\t\t\tdst[px+1] = f1*rgb.g + f2*g1 + f3*g2;\n\t\t\t\t\tdst[px+2] = f1*rgb.b + f2*b1 + f3*b2;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'saturation':\n\t\t\t\t\tvar hsl =rgb2hsv(r1,g1,b1);\n\t\t\t\t\tvar hsl2=rgb2hsv(r2,g2,b2);\n\t\t\t\t\tvar rgb=hsv2rgb(hsl.h, hsl2.s, hsl.v);\n\t\t\t\t\tdst[px]   = f1*rgb.r + f2*r1 + f3*r2;\n\t\t\t\t\tdst[px+1] = f1*rgb.g + f2*g1 + f3*g2;\n\t\t\t\t\tdst[px+2] = f1*rgb.b + f2*b1 + f3*b2;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'lightercolor':\n\t\t\t\t\tvar rgb = 2.623*(r1-r2)+5.15*(g1-g2)+b1-b2>0 ? {r:r1,g:g1,b:b1} : {r:r2,g:g2,b:b2};\n\t\t\t\t\tdst[px]   = f1*rgb.r + f2*r1 + f3*r2;\n\t\t\t\t\tdst[px+1] = f1*rgb.g + f2*g1 + f3*g2;\n\t\t\t\t\tdst[px+2] = f1*rgb.b + f2*b1 + f3*b2;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'darkercolor':\n\t\t\t\t\tvar rgb = 2.623*(r1-r2)+5.15*(g1-g2)+b1-b2<0 ? {r:r1,g:g1,b:b1} : {r:r2,g:g2,b:b2};\n\t\t\t\t\tdst[px]   = f1*rgb.r + f2*r1 + f3*r2;\n\t\t\t\t\tdst[px+1] = f1*rgb.g + f2*g1 + f3*g2;\n\t\t\t\t\tdst[px+2] = f1*rgb.b + f2*b1 + f3*b2;\n\t\t\t\tbreak;\n\n\t\t\t\tdefault: // ******* UNSUPPORTED mode, produces yellow/magenta checkerboard\n\t\t\t\t\tvar col = (px/4) % this.canvas.width,\n\t\t\t\t\t    row = Math.floor((px/4) / this.canvas.width),\n\t\t\t\t\t    odd = (col%8<4 && row%8<4) || (col%8>3 && row%8>3);\n\t\t\t\t\tdst[px] = dst[px+3] = 255;\n\t\t\t\t\tdst[px+1] = odd ? 255 : 0;\n\t\t\t\t\tdst[px+2] = odd ? 0 : 255;\n\t\t\t}\n\t\t}\n\t\tdestContext.putImageData(dstD,offsets.destX,offsets.destY);\n}\n\n})();\n\n//# sourceURL=webpack://etchy/./src/ContextBlender.js?");

/***/ }),

/***/ "./src/FriendlyWebSocket.js":
/*!**********************************!*\
  !*** ./src/FriendlyWebSocket.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ FriendlyWebSocket)\n/* harmony export */ });\n/* A Friendly WebSocket */\n\n// FOUND HERE: https://glitch.com/edit/#!/starter-ws\n\n// WebSockets are awesome, but they have a nasty habit of disconnecting\n// and not waking back up. This class is a wrapper around WebSocket that\n// handles automatic reconnection.\n\nclass FriendlyWebSocket {\n  // optional customization of the websocket path\n  constructor({ path = \"/\", url } = {}) {\n    this.path = path;\n    this.url = url;\n    this.connect();\n    this.connected = false;\n    this._listeners = {\n      message: new Set(),\n      open: new Set(),\n      close: new Set()\n    };\n  }\n\n  connect() {\n    let protocol = 'ws://';\n    if (location.protocol === 'https:') {\n      protocol = 'wss://';\n    }\n    \n    let url = this.url || (protocol + location.host + this.path);\n    \n    this.socket = new WebSocket(url);\n\n    // Connection opened\n    this.socket.addEventListener(\"open\", event => {\n      console.log(\"connected!\");\n      this.connected = true;\n      this._emit('open');\n      // this isn't necessary, but it's polite to say hi!\n      // this.socket.send(\"Hello Server!\");\n    });\n\n    this.socket.addEventListener(\"close\", event => {\n      console.log(\"disconnected, trying to reconnect\");\n      this.connected = false;\n      // the server went away, try re-connecting in 1 seconds.\n      this._emit('close');\n      setTimeout(() => this.connect(), 1000);\n    });\n\n    // Listen for messages\n    this.socket.addEventListener(\"message\", event => {\n      // tell the listeners about it\n      this._emit('message', event.data);\n    });\n  }\n\n  _emit(type, data) {\n    this._listeners[type].forEach(handler => {\n      // don't let one listener spoil the batch\n      try {\n        handler(data);\n      } catch (e) {\n        console.warn(\"error in message handler\", e);\n      }\n    });\n  }\n  \n  on(type, handler) {\n    if (type in this._listeners) {\n      this._listeners[type].add(handler);\n    }\n  }\n\n  off(type, handler) {\n    if (type === \"message\") {\n      this.messageHandlers.delete(handler);\n    }\n  }\n\n  send(message) {\n    if (this.connected) {\n      this.socket.send(message);\n    }\n  }\n}\n\n\n//# sourceURL=webpack://etchy/./src/FriendlyWebSocket.js?");

/***/ }),

/***/ "./src/index.js":
/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _FriendlyWebSocket__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./FriendlyWebSocket */ \"./src/FriendlyWebSocket.js\");\n/* harmony import */ var _ContextBlender__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ContextBlender */ \"./src/ContextBlender.js\");\n/* harmony import */ var _ContextBlender__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_ContextBlender__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _webrtc_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./webrtc_utils */ \"./src/webrtc_utils.js\");\n/* harmony import */ var _webrtc_utils__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_webrtc_utils__WEBPACK_IMPORTED_MODULE_2__);\n/*\n  ETCHY\n  \n  This project uses webrtc to establish a connection between two users.\n  server/server.js contains the webrtc signaling server\n  \n  When a user establishes a connection, each webcam turns on. Each user\n  can sketch on a canvas, which is used to mask the raw video. The composite\n  canvas (sketch + raw video) is then made into a stream and sent to the other \n  user.\n  \n  Disconnections are frequent which I think is more of a webrtc problem,\n  if they occur it's best to just wait it out or refresh.\n  \n  TODO:\n  \n  fix on ios (works on everything but ios!)\n    video elements all have to be muted, playinline, and autoplay\n    \n    works on safari (atm) but not on chrome ios\n  \n  multiple peers\n  drawing customization\n  add image!\n  variable blend mode \n  (connection-level) blend modes?\n  variable brushes (different types)\n  \n  HELPFUL LINKS:\n  recognizing temporary or full disconnects\n  https://stackoverflow.com/questions/63582725/webrtc-differentiate-between-temporary-disconnect-or-failure-and-permanant\n  \n  NOTE: \n  \n  this project makes use of context-blender\n                https://github.com/Phrogz/context-blender\n  the 'multiply' and 'screen' blend modes in particular don't seem to have good browser\n  compatibility, particularly on mobile.\n*/\n\n\n\n\n\n// if the code of conduct has been agreed to\nif (localStorage.getItem(\"agreeToCC\")) {\n  document.getElementById(\"CODEOFCONDUCT\").style.display = \"none\";\n\n  // https://stackoverflow.com/questions/25158696/blend-modemultiply-in-internet-explorer\n  // this helps make 'multiply' more browser compatible!\n  function multiply(c0, c1, R, G, B) {\n    let _ctx = c0.getContext('2d');\n    var imgData0 = _ctx0.getImageData(0, 0, c0.width, c0.height);\n    var data0 = imgData0.data;\n\n    for (var i = 0; i < data.length; i += 4) {\n      data[i] = (R * data[i]) / 255;\n      data[i + 1] = (G * data[i + 1]) / 255;\n      data[i + 2] = (B * data[i + 2]) / 255;\n    }\n\n    ctx.putImageData(imgData, 0, 0);\n  }\n  \n  // https://www.w3.org/TR/compositing-1/#blendingscreen  \n  function screen(c0,c1) {\n    let _ctx0 = c0.getContext('2d');\n    let _ctx1 = c1.getContext('2d');\n    var imgData0 = _ctx0.getImageData(0, 0, c0.width, c0.height);\n    var data0 = imgData0.data;\n    var imgData1 = _ctx1.getImageData(0, 0, c1.width, c1.height);\n    var data1 = imgData1.data;\n\n    for (var i = 0; i < data0.length; i += 4) {\n      data1[i] = 1 - ((1 - (data0[i]/255)) * (1 - (data1[i]/255)));\n      // data1[i + 1] = (data[i + 1]) / 255;\n      // data1[i + 2] = (data[i + 2]) / 255;\n    }\n\n    _ctx1.putImageData(imgData1, 0, 0);\n  }\n\n  // https://stackoverflow.com/questions/6860853/generate-random-string-for-div-id\n  function guidGenerator() {\n    var S4 = function() {\n      return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\n    };\n    return S4() + S4();\n  }\n\n  let user_id = guidGenerator();\n\n  let pc;\n  let offer_sent = false;\n  let answer_sent = false;\n  let peer_id = undefined;\n  let localStream, sketchStream, compositeStream;\n\n  let countElement = document.querySelector(\".count\");\n  let peersElement = document.querySelector(\"#peers\");\n\n  let canvas = document.getElementById(\"mainCanvas\");\n  let ctx = canvas.getContext(\"2d\");\n  canvas.width = 640;\n  canvas.height = 480;\n\n  let sketchCanvas = document.getElementById(\"sketchCanvas\");\n  let sketchCtx = sketchCanvas.getContext(\"2d\");\n  sketchCanvas.width = 640;\n  sketchCanvas.height = 480;\n\n  let cameraCanvas = document.getElementById(\"cameraCanvas\");\n  let cameraCtx = cameraCanvas.getContext(\"2d\");\n  cameraCanvas.width = 640;\n  cameraCanvas.height = 480;\n\n  let left_dragging = false;\n  let right_dragging = false;\n  let middle_dragging = false;\n\n  let main_update_loop, camera_update_loop;\n\n  let fade = true;\n  let fadeAmount = 0.1;\n  let update_rate = 50;\n  let brush_radius = 20;\n\n  let mouse;\n\n  let message_index = 0;\n  let current_message = \"\";\n\n  let main_blend_mode = \"screen\";\n  let local_blend_mode = \"multiply\";\n\n  // ------------------------------------------------------------\n  // setting up websocket signaling server\n  const websocket = new _FriendlyWebSocket__WEBPACK_IMPORTED_MODULE_0__.default({ path: \"/\" });\n\n  const createPeerConnection = (isOfferer = false) => {\n    const pc = new RTCPeerConnection({\n      iceServers: [\n        // { urls: \"stun:stun.1.google.com:19302\" },\n        { urls: \"turn:quickturn.glitch.me\", username: \"n/a\", credential: \"n/a\" }\n      ],\n      // offerToReceiveAudio: false,\n      // offerToReceiveVideo: true,\n      voiceActivityDetection: false\n    });\n\n    pc.onicecandidate = () => {\n      if (event.candidate) {\n        send({\n          from_id: user_id,\n          to_id: peer_id,\n          type: \"candidate\",\n          candidate: event.candidate\n        });\n      }\n    };\n\n    pc.onicecandidateerror = err => {\n      // console.error(err);\n    };\n\n    pc.oniceconnectionstatechange = async function() {\n      // console.log(\"ice connection state changed\", pc.iceConnectionState);\n\n      switch (pc.iceConnectionState) {\n        case \"disconnected\":\n          break;\n        case \"closed\":\n          break;\n        case \"failed\":\n          break;\n      }\n\n      let isDisconnectPermanent = await (0,_webrtc_utils__WEBPACK_IMPORTED_MODULE_2__.checkStatePermanent)(\n        pc,\n        pc.iceConnectionState\n      );\n\n      if (isDisconnectPermanent) {\n        alert(\"the person you were connected to has disappeared\");\n        reset();\n      }\n    };\n\n    pc.ontrack = event => {\n      let ele = document.querySelector(\"#peerRemote\");\n\n      if (event.streams && event.streams[0]) {\n        ele.srcObject = event.streams[0];\n      } else {\n        let inboundStream = new MediaStream(event.track);\n        ele.srcObject = inboundStream;\n      }\n\n      ele.autoplay = true;\n      ele.controls = true;\n      ele.playsInline = true;\n      ele.muted = true;\n\n      document.getElementById(\"local-video\").play();\n      document.getElementById(\"local-sketch\").play();\n      document.getElementById(\"local-composite\").play();\n      document.getElementById(\"peerRemote\").play();\n    };\n\n    // TODO: probably still needs to be added\n    // if (isOfferer) {\n    // pc.onnegotiationneeded = () => {\n    //   sendOffer();\n    // };\n    // }\n\n    return pc;\n  };\n\n  const sendOffer = () => {\n    if (!peer_id) return;\n    // console.log(\"Send offer to \" + peer_id);\n    return pc\n      .createOffer()\n      .then(setAndSendLocalDescription)\n      .then(() => {\n        offer_sent = true;\n      })\n      .catch(err => {\n        console.error(err);\n      });\n  };\n\n  const sendAnswer = () => {\n    if (!peer_id) return;\n    // console.log(\"Send answer to \" + peer_id);\n    return pc\n      .createAnswer()\n      .then(setAndSendLocalDescription)\n      .then(() => {\n        answer_sent = true;\n      })\n      .catch(err => {\n        console.error(err);\n      });\n  };\n\n  const setAndSendLocalDescription = sdp => {\n    return pc\n      .setLocalDescription(sdp)\n      .then(() => {\n        send({\n          from_id: user_id,\n          to_id: peer_id,\n          type: sdp.type,\n          sdp: sdp\n        });\n      })\n      .catch(err => {\n        console.error(err);\n      });\n  };\n\n  const handlePeerClick = e => {\n    offer_sent = false;\n    answer_sent = false;\n    peer_id = e.target.innerHTML;\n    addCamera()\n      .then(sendOffer)\n      .catch(err => {\n        console.error(err);\n      });\n    hideLobby();\n    showLoading();\n    // showControls();\n  };\n\n  const addCamera = () => {\n    // if(localStream) return;\n    return navigator.mediaDevices\n      .getUserMedia({\n        audio: false,\n        // video: true\n        video: { width: 640, height: 480 }\n      })\n      .then(stream => {\n        console.log(\"adding camera\");\n        localStream = stream;\n        compositeStream = cameraCanvas.captureStream();\n        sketchStream = sketchCanvas.captureStream();\n\n        initializeSketchCanvas();\n        compositeStream.getTracks().forEach(track => {\n          pc.addTrack(track, compositeStream);\n        });\n\n        document.getElementById(\"local-video\").srcObject = localStream;\n        document.getElementById(\"local-sketch\").srcObject = sketchStream;\n        document.getElementById(\"local-composite\").srcObject = compositeStream;\n\n        document.getElementById(\"local-video\").play();\n        document.getElementById(\"local-sketch\").play();\n        document.getElementById(\"local-composite\").play();\n        // document.getElementById(\"peerRemote\").play();\n\n        // startup the main output loop\n        if (main_update_loop) {\n          clearInterval(main_update_loop);\n          main_update_loop = setInterval(updateMainCanvas, update_rate);\n        } else {\n          main_update_loop = setInterval(updateMainCanvas, update_rate);\n        }\n      })\n      .catch(err => {\n        console.error(err);\n      });\n  };\n\n  // REGISTER when connection opens\n  websocket.on(\"open\", data => {\n    document.querySelector(\".yourId\").innerText = `(you) ${user_id}`;\n    send({ type: \"register\", user_id: user_id });\n    pc = createPeerConnection();\n  });\n\n  // when signaling server sends a message\n  websocket.on(\"message\", data => {\n    data = JSON.parse(event.data);\n\n    switch (data.type) {\n      case \"count\":\n        // clear all buttons\n        Array.from(peersElement.children).forEach(e => {\n          e.removeEventListener(\"click\", handlePeerClick);\n          peersElement.removeChild(e);\n        });\n\n        if (data.peers.length === 1) {\n          let ele = document.createElement(\"em\");\n\n          ele.innerText = \"~ nobody is online! ~\";\n          peersElement.appendChild(ele);\n        } else {\n          for (let i = 0; i < data.peers.length; i++) {\n            if (data.peers[i].user_id !== user_id) {\n              let btn = document.createElement(\"button\");\n              btn.innerHTML = data.peers[i].user_id;\n              btn.addEventListener(\"click\", handlePeerClick);\n              peersElement.appendChild(btn);\n            }\n          }\n        }\n\n        break;\n      case \"offer\":\n        /* \n          when an offer is received, the user on the receiving end\n          should be given the opportunity to accept or deny\n        */\n        if (offer_sent || window.confirm(data.from_id + \" wants to connect\")) {\n          peer_id = data.from_id;\n          document.querySelector(\".peerId\").innerText = `⟷ ${peer_id} (them)`;\n          pc.setRemoteDescription(data.sdp)\n            .then(sendAnswer)\n            .then(addCamera)\n            .then(() => {\n              hideLobby();\n              showControls();\n              if (!offer_sent) sendOffer();\n            })\n            .catch(error => console.error(error));\n        } else {\n          // tell sender no thank you\n          send({\n            from_id: user_id,\n            to_id: data.from_id,\n            type: \"rejectOffer\"\n          });\n        }\n        break;\n      case \"answer\":\n        peer_id = data.from_id;\n        document.querySelector(\".peerId\").innerText = `⟷ ${peer_id} (them)`;\n        pc.setRemoteDescription(data.sdp)\n          .then(addCamera)\n          .then(() => {\n            hideLoading();\n            showControls();\n          })\n          .catch(error => console.error(error));\n        break;\n      case \"candidate\":\n        if (!pc || !pc.remoteDescription) {\n          pc.addIceCandidate(data.candidate);\n        }\n        break;\n      case \"rejectOffer\":\n        alert(\n          \"the other user declined (or just closed their tab, something like that)\"\n        );\n        reset();\n        break;\n      default:\n        break;\n    }\n  });\n\n  const reset = () => {\n    showLobby();\n    hideLoading();\n    hideControls();\n    peer_id = undefined;\n    document.querySelector(\".peerId\").innerText = \"\";\n    offer_sent = false;\n    answer_sent = false;\n\n    // reregister?\n    send({ type: \"register\", user_id: user_id });\n  };\n\n  const send = data => {\n    websocket.send(JSON.stringify(data));\n  };\n\n  const showLobby = () => {\n    document.querySelector(\".center\").style.display = \"flex\";\n  };\n\n  const hideLobby = () => {\n    document.querySelector(\".center\").style.display = \"none\";\n  };\n\n  const showLoading = () => {\n    document.querySelector(\".loading\").style.display = \"flex\";\n  };\n\n  const hideLoading = () => {\n    document.querySelector(\".loading\").style.display = \"none\";\n  };\n\n  const showControls = () => {\n    document.querySelector(\"#controls\").style.display = \"flex\";\n  };\n\n  const hideControls = () => {\n    document.querySelector(\"#controls\").style.display = \"none\";\n  };\n\n  // composite final output\n  const updateMainCanvas = () => {\n    if (fade) updateSketchCanvas();\n    updateCameraCanvas();\n\n    let v1 = document.querySelector(\"#local-composite\");\n    let v2 = document.querySelector(\"#peerRemote\");\n\n    if (v2) ctx.drawImage(v2, 0, 0);\n\n    ctx.save();\n    // ctx.globalCompositeOperation = main_blend_mode;\n    // if (v1) ctx.drawImage(v1, 0, 0);\n    // if (v1) v1.blendOnto(v2,'screen');\n    if (v1) screen(canvas);\n    ctx.restore();\n  };\n\n  // this fades away the sketch while drawing\n  const updateSketchCanvas = () => {\n    sketchCtx.save();\n\n    // I can't decide what value this should be at\n    // a longer tail on the fade looks better but\n    // leaves the background with artifacts\n    sketchCtx.globalAlpha = fadeAmount;\n    sketchCtx.fillStyle = \"black\";\n    sketchCtx.fillRect(0, 0, sketchCanvas.width, sketchCanvas.height);\n    sketchCtx.fillStyle = \"white\";\n    sketchCtx.restore();\n\n    sketchCtx.globalAlpha = 1.0;\n\n    // draw circle\n    if (left_dragging) {\n      sketchCtx.fillStyle = \"white\";\n      sketchCtx.beginPath();\n      sketchCtx.ellipse(\n        mouse.x,\n        mouse.y,\n        brush_radius,\n        brush_radius,\n        Math.PI / 4,\n        0,\n        2 * Math.PI\n      );\n      sketchCtx.fill();\n      sketchCtx.closePath();\n    }\n\n    // erase\n    if (middle_dragging) {\n      sketchCtx.fillStyle = \"black\";\n      sketchCtx.beginPath();\n      sketchCtx.ellipse(\n        mouse.x,\n        mouse.y,\n        brush_radius,\n        brush_radius,\n        Math.PI / 4,\n        0,\n        2 * Math.PI\n      );\n      sketchCtx.fill();\n      sketchCtx.closePath();\n    }\n\n    // draw text\n    if (right_dragging) {\n      let current_symbol = current_message.split(\"\")[message_index];\n      // space out message\n      if (current_frame % 4 === 0) {\n        // draw message\n        sketchCtx.font = brush_radius * 4 + \"px Times New Roman\";\n        sketchCtx.fillStyle = \"white\";\n        sketchCtx.fillText(\n          current_message.split(\"\")[message_index],\n          mouse.x + brush_radius,\n          mouse.y + brush_radius\n        );\n\n        // message_index = (message_index + 1) % current_message.split(\"\").length;\n        message_index++;\n        if (message_index >= current_message.split(\"\").length) {\n          right_dragging = false;\n        }\n      }\n\n      current_frame++;\n    }\n  };\n\n  // here I am masking out the video with the sketch (composite)\n  const updateCameraCanvas = () => {\n    let v1 = document.querySelector(\"#local-video\");\n    let v2 = document.querySelector(\"#local-sketch\");\n\n    if (v1) cameraCtx.drawImage(v1, 0, 0);\n\n    cameraCtx.save();\n    \n    // cameraCtx.globalCompositeOperation = local_blend_mode;\n    // if (v2) cameraCtx.drawImage(v2, 0, 0);\n    if (v2) multiply(cameraCanvas, 1,1,1);\n    // if (v2) v2.blendOnto(v1,'multiply');\n    cameraCtx.restore();\n  };\n\n  // draw sketch that can be later be used as a mask\n  const initializeSketchCanvas = () => {\n    sketchCtx.save();\n    sketchCtx.clearRect(0, 0, sketchCanvas.width, sketchCanvas.height);\n    sketchCtx.fillStyle = \"black\";\n    sketchCtx.fillRect(0, 0, sketchCanvas.width, sketchCanvas.height);\n    sketchCtx.restore();\n  };\n\n  let current_frame = 0;\n  const handleMouseMove = e => {\n    if (right_dragging || left_dragging || middle_dragging) {\n      let event = e.touches ? e.touches[0] : e;\n      let bounds = canvas.getBoundingClientRect();\n      mouse = { x: event.clientX - bounds.x, y: event.clientY - bounds.y };\n    }\n  };\n\n  const handleMouseDown = e => {\n    if (e.button === 0) {\n      left_dragging = true;\n    } else if (e.button === 1) {\n      middle_dragging = true;\n    } else if (e.button === 2) {\n      right_dragging = true;\n      // spell it out from the beginning\n      message_index = 0;\n    }\n\n    if (e.touches) {\n      if (e.touches.length === 1) {\n        left_dragging = true;\n      } else if (e.touches.length === 3) {\n        middle_dragging = true;\n      } else if (e.touches.length === 2) {\n        right_dragging = true;\n        message_index = 0;\n      }\n    }\n\n    let event = e.touches ? e.touches[0] : e;\n    let bounds = canvas.getBoundingClientRect();\n    mouse = { x: event.clientX - bounds.x, y: event.clientY - bounds.y };\n  };\n\n  const handleMouseUp = e => {\n    if (e.button === 0) {\n      left_dragging = false;\n    } else if (e.button === 1) {\n      middle_dragging = false;\n    } else if (e.button === 2) {\n      right_dragging = false;\n    }\n\n    if (e.touches) {\n      if (e.touches.length === 1) {\n        left_dragging = false;\n      } else if (e.touches.length === 3) {\n        middle_dragging = false;\n      } else if (e.touches.length === 2) {\n        right_dragging = false;\n      }\n    }\n\n    let event = e.touches ? e.touches[0] : e;\n    let bounds = canvas.getBoundingClientRect();\n    mouse = { x: event.clientX - bounds.x, y: event.clientY - bounds.y };\n  };\n\n  const handleBrushRadiusChange = e => {\n    document.querySelector(\"#brushRadiusValue\").innerHTML = e.target.value;\n    brush_radius = e.target.value;\n  };\n\n  const handleFadeAmountChange = e => {\n    document.querySelector(\"#fadeAmountValue\").innerHTML = e.target.value;\n    fadeAmount = e.target.value;\n  };\n\n  const handleClearButton = () => {\n    initializeSketchCanvas();\n    // sketchCtx.clearRect(0, 0, sketchCanvas.width, sketchCanvas.height);\n  };\n\n  const handleToggleFade = () => {\n    fade = !fade;\n    document.querySelector(\"#fadeToggle\").innerHTML = fade\n      ? \"dont fade away\"\n      : \"fade away\";\n  };\n\n  const handleSnapButton = () => {\n    /*\n      saves an image of the current canvas\n    */\n    console.log(\"saving snapshot\");\n    let uri = canvas.toDataURL(\"image/png\");\n    let link = document.createElement(\"a\");\n    link.download = `${user_id}`;\n\n    if (window.webkitURL != null) {\n      // Chrome allows the link to be clicked without actually adding it to the DOM.\n      link.href = uri;\n    } else {\n      // Firefox requires the link to be added to the DOM before it can be clicked.\n      link.href = uri;\n      link.onclick = e => document.body.removeChild(e.target);\n      link.style.display = \"none\";\n      document.body.appendChild(link);\n    }\n\n    link.click();\n  };\n\n  const handleLocalBlendMode = e => {\n    console.log(\"handleLocalBlendMode\", e.target.value);\n    local_blend_mode = e.target.value;\n  };\n\n  const handleGlobalBlendMode = e => {\n    console.log(\"handleGlobalBlendMode\", e.target.value);\n    main_blend_mode = e.target.value;\n  };\n\n  const handleContextMenu = e => {\n    e.preventDefault();\n  };\n\n  const handleMessageChange = e => {\n    current_message = e.target.value;\n  };\n\n  initializeSketchCanvas();\n\n  const handleWheel = e => {\n    fadeAmount += (e.deltaY * -1) / 1000;\n\n    if (fadeAmount > 1) fadeAmount = 1;\n    if (fadeAmount <= 0) fadeAmount = 0;\n\n    console.log(e.deltaY);\n\n    document.getElementById(\"fadeAmount\").value = fadeAmount;\n    document.querySelector(\"#fadeAmountValue\").innerHTML = fadeAmount.toFixed(\n      2\n    );\n  };\n\n  window.addEventListener(\n    \"resize\",\n    e => {\n      // if(window.innerWidth < 640 || window.innerHeight < 480) {\n      //   let aspect = 480 / 640;\n      //   canvas.width = window.innerWidth;\n      //   canvas.height = window.innerHeight * aspect;\n      // } else {\n      //   canvas.width = 640;\n      //   canvas.height = 480;\n      // }\n    },\n    true\n  );\n\n  document.addEventListener(\"contextmenu\", handleContextMenu, false);\n\n  document.addEventListener(\"mousedown\", handleMouseDown, false);\n  document.addEventListener(\"mousemove\", handleMouseMove, false);\n  document.addEventListener(\"mouseup\", handleMouseUp, false);\n\n  canvas.addEventListener(\n    \"touchstart\",\n    e => {\n      e.preventDefault();\n      handleMouseDown(e);\n    },\n    false\n  );\n  canvas.addEventListener(\n    \"touchmove\",\n    e => {\n      handleMouseMove(e);\n    },\n    false\n  );\n  canvas.addEventListener(\n    \"touchend\",\n    e => {\n      handleMouseUp(e);\n    },\n    false\n  );\n\n  document.querySelector(\"#brushRadiusValue\").innerHTML = brush_radius;\n  document.querySelector(\"#brushRadiusValue\").value = brush_radius;\n\n  document\n    .querySelector(\"#brushRadius\")\n    .addEventListener(\"input\", handleBrushRadiusChange, false);\n  document\n    .querySelector(\"#clearButton\")\n    .addEventListener(\"click\", handleClearButton, false);\n  document\n    .querySelector(\"#fadeToggle\")\n    .addEventListener(\"click\", handleToggleFade, false);\n  document\n    .querySelector(\"#fadeAmount\")\n    .addEventListener(\"input\", handleFadeAmountChange, false);\n  document\n    .querySelector(\"#snapButton\")\n    .addEventListener(\"click\", handleSnapButton, false);\n\n  document.querySelector(\"#fadeAmountValue\").innerHTML = fadeAmount;\n  document.querySelector(\"#fadeAmountValue\").value = fadeAmount;\n\n  document\n    .querySelector(\"#localBlendMode\")\n    .addEventListener(\"change\", handleLocalBlendMode, false);\n  document\n    .querySelector(\"#globalBlendMode\")\n    .addEventListener(\"change\", handleGlobalBlendMode, false);\n\n  document\n    .querySelector(\"#brushMessage\")\n    .addEventListener(\"input\", handleMessageChange, false);\n\n  document.addEventListener(\"wheel\", handleWheel, false);\n} else {\n  // FOR CODE OF CONDUCT\n\n  document.getElementById(\"CODEOFCONDUCT\").style.display = \"flex\";\n\n  // CODE OF CONDUCT\n  document.getElementById(\"agreeCC\").addEventListener(\"click\", () => {\n    localStorage.setItem(\"agreeToCC\", true);\n    window.location.reload();\n  });\n\n  document.getElementById(\"disagreeCC\").addEventListener(\"click\", () => {\n    localStorage.setItem(\"agreeToCC\", false);\n    window.open(\"https://www.google.com/search?q=am+i+an+asshole\");\n  });\n}\n\n\n//# sourceURL=webpack://etchy/./src/index.js?");

/***/ }),

/***/ "./src/webrtc_utils.js":
/*!*****************************!*\
  !*** ./src/webrtc_utils.js ***!
  \*****************************/
/***/ ((module) => {

eval("// https://stackoverflow.com/questions/63582725/webrtc-differentiate-between-temporary-disconnect-or-failure-and-permanant\nlet con;\n\nconst customdelay = ms => new Promise(res => setTimeout(res, ms));\n\nasync function checkStatePermanent(_con, iceState) {\n  con = _con;\n  videoReceivedBytetCount = 0;\n  audioReceivedByteCount = 0;\n\n  let firstFlag = await isPermanentDisconnect();\n\n  await customdelay(2000);\n\n  let secondFlag = await isPermanentDisconnect(); //Call this func again after 2 seconds to check whether data is still coming in.\n\n  if (secondFlag) {\n    //If permanent disconnect then we hangup i.e no audio/video is fllowing\n    if (iceState == \"disconnected\") {\n      console.log('permanent disconnect')\n      \n      return true;\n      // hangUpCall(); //Hangup instead of closevideo() because we want to record call end in db\n    }\n  }\n  if (!secondFlag) {\n    console.log('temporary failure to connect')\n    \n    //If temp failure then restart ice i.e audio/video is still flowing\n    if (iceState == \"failed\") {\n      con.restartIce();\n    }\n    \n    return false;\n  }\n}\n\nvar videoReceivedBytetCount = 0;\nvar audioReceivedByteCount = 0;\n\nasync function isPermanentDisconnect() {\n  var isPermanentDisconnectFlag = false;\n  var videoIsAlive = false;\n  var audioIsAlive = false;\n\n  await con.getStats(null).then(stats => {\n    stats.forEach(report => {\n      if (\n        report.type === \"inbound-rtp\" &&\n        (report.kind === \"audio\" || report.kind === \"video\")\n      ) {\n        //check for inbound data only\n        if (report.kind === \"audio\") {\n          //Here we must compare previous data count with current\n          if (report.bytesReceived > audioReceivedByteCount) {\n            // If current count is greater than previous then that means data is flowing to other peer. So this disconnected or failed ICE state is temporary\n            audioIsAlive = true;\n          } else {\n            audioIsAlive = false;\n          }\n          audioReceivedByteCount = report.bytesReceived;\n        }\n        if (report.kind === \"video\") {\n          if (report.bytesReceived > videoReceivedBytetCount) {\n            // If current count is greater than previous then that means data is flowing to other peer. So this disconnected or failed ICE state is temporary\n            videoIsAlive = true;\n          } else {\n            videoIsAlive = false;\n          }\n          videoReceivedBytetCount = report.bytesReceived;\n        }\n        if (audioIsAlive || videoIsAlive) {\n          //either audio or video is being recieved.\n          isPermanentDisconnectFlag = false; //Disconnected is temp\n        } else {\n          isPermanentDisconnectFlag = true;\n        }\n      }\n    });\n  });\n\n  return isPermanentDisconnectFlag;\n}\n\nmodule.exports = {\n  checkStatePermanent,\n  isPermanentDisconnect\n};\n\n\n//# sourceURL=webpack://etchy/./src/webrtc_utils.js?");

/***/ }),

/***/ "../rbd/pnpm-volume/7461d640-0f67-4c49-a77d-db2fb185b90f/node_modules/.registry.npmjs.org/canvas/2.8.0/node_modules/canvas/browser.js":
/*!********************************************************************************************************************************************!*\
  !*** ../rbd/pnpm-volume/7461d640-0f67-4c49-a77d-db2fb185b90f/node_modules/.registry.npmjs.org/canvas/2.8.0/node_modules/canvas/browser.js ***!
  \********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("/* globals document, ImageData */\n\nconst parseFont = __webpack_require__(/*! ./lib/parse-font */ \"../rbd/pnpm-volume/7461d640-0f67-4c49-a77d-db2fb185b90f/node_modules/.registry.npmjs.org/canvas/2.8.0/node_modules/canvas/lib/parse-font.js\")\n\nexports.parseFont = parseFont\n\nexports.createCanvas = function (width, height) {\n  return Object.assign(document.createElement('canvas'), { width: width, height: height })\n}\n\nexports.createImageData = function (array, width, height) {\n  // Browser implementation of ImageData looks at the number of arguments passed\n  switch (arguments.length) {\n    case 0: return new ImageData()\n    case 1: return new ImageData(array)\n    case 2: return new ImageData(array, width)\n    default: return new ImageData(array, width, height)\n  }\n}\n\nexports.loadImage = function (src, options) {\n  return new Promise(function (resolve, reject) {\n    const image = Object.assign(document.createElement('img'), options)\n\n    function cleanup () {\n      image.onload = null\n      image.onerror = null\n    }\n\n    image.onload = function () { cleanup(); resolve(image) }\n    image.onerror = function () { cleanup(); reject(new Error('Failed to load the image \"' + src + '\"')) }\n\n    image.src = src\n  })\n}\n\n\n//# sourceURL=webpack://etchy/../rbd/pnpm-volume/7461d640-0f67-4c49-a77d-db2fb185b90f/node_modules/.registry.npmjs.org/canvas/2.8.0/node_modules/canvas/browser.js?");

/***/ }),

/***/ "../rbd/pnpm-volume/7461d640-0f67-4c49-a77d-db2fb185b90f/node_modules/.registry.npmjs.org/canvas/2.8.0/node_modules/canvas/lib/parse-font.js":
/*!***************************************************************************************************************************************************!*\
  !*** ../rbd/pnpm-volume/7461d640-0f67-4c49-a77d-db2fb185b90f/node_modules/.registry.npmjs.org/canvas/2.8.0/node_modules/canvas/lib/parse-font.js ***!
  \***************************************************************************************************************************************************/
/***/ ((module) => {

"use strict";
eval("\n\n/**\n * Font RegExp helpers.\n */\n\nconst weights = 'bold|bolder|lighter|[1-9]00'\n  , styles = 'italic|oblique'\n  , variants = 'small-caps'\n  , stretches = 'ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded'\n  , units = 'px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q'\n  , string = '\\'([^\\']+)\\'|\"([^\"]+)\"|[\\\\w\\\\s-]+'\n\n// [ [ <‘font-style’> || <font-variant-css21> || <‘font-weight’> || <‘font-stretch’> ]?\n//    <‘font-size’> [ / <‘line-height’> ]? <‘font-family’> ]\n// https://drafts.csswg.org/css-fonts-3/#font-prop\nconst weightRe = new RegExp('(' + weights + ') +', 'i')\nconst styleRe = new RegExp('(' + styles + ') +', 'i')\nconst variantRe = new RegExp('(' + variants + ') +', 'i')\nconst stretchRe = new RegExp('(' + stretches + ') +', 'i')\nconst sizeFamilyRe = new RegExp(\n  '([\\\\d\\\\.]+)(' + units + ') *'\n  + '((?:' + string + ')( *, *(?:' + string + '))*)')\n\n/**\n * Cache font parsing.\n */\n\nconst cache = {}\n\nconst defaultHeight = 16 // pt, common browser default\n\n/**\n * Parse font `str`.\n *\n * @param {String} str\n * @return {Object} Parsed font. `size` is in device units. `unit` is the unit\n *   appearing in the input string.\n * @api private\n */\n\nmodule.exports = function (str) {\n  // Cached\n  if (cache[str]) return cache[str]\n\n  // Try for required properties first.\n  const sizeFamily = sizeFamilyRe.exec(str)\n  if (!sizeFamily) return // invalid\n\n  // Default values and required properties\n  const font = {\n    weight: 'normal',\n    style: 'normal',\n    stretch: 'normal',\n    variant: 'normal',\n    size: parseFloat(sizeFamily[1]),\n    unit: sizeFamily[2],\n    family: sizeFamily[3].replace(/[\"']/g, '').replace(/ *, */g, ',')\n  }\n\n  // Optional, unordered properties.\n  let weight, style, variant, stretch\n  // Stop search at `sizeFamily.index`\n  let substr = str.substring(0, sizeFamily.index)\n  if ((weight = weightRe.exec(substr))) font.weight = weight[1]\n  if ((style = styleRe.exec(substr))) font.style = style[1]\n  if ((variant = variantRe.exec(substr))) font.variant = variant[1]\n  if ((stretch = stretchRe.exec(substr))) font.stretch = stretch[1]\n\n  // Convert to device units. (`font.unit` is the original unit)\n  // TODO: ch, ex\n  switch (font.unit) {\n    case 'pt':\n      font.size /= 0.75\n      break\n    case 'pc':\n      font.size *= 16\n      break\n    case 'in':\n      font.size *= 96\n      break\n    case 'cm':\n      font.size *= 96.0 / 2.54\n      break\n    case 'mm':\n      font.size *= 96.0 / 25.4\n      break\n    case '%':\n      // TODO disabled because existing unit tests assume 100\n      // font.size *= defaultHeight / 100 / 0.75\n      break\n    case 'em':\n    case 'rem':\n      font.size *= defaultHeight / 0.75\n      break\n    case 'q':\n      font.size *= 96 / 25.4 / 4\n      break\n  }\n\n  return (cache[str] = font)\n}\n\n\n//# sourceURL=webpack://etchy/../rbd/pnpm-volume/7461d640-0f67-4c49-a77d-db2fb185b90f/node_modules/.registry.npmjs.org/canvas/2.8.0/node_modules/canvas/lib/parse-font.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/index.js");
/******/ 	
/******/ })()
;